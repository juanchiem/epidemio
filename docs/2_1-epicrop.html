<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Epicrop | Epidemiologia de enfermedades de cultivos</title>
  <meta name="description" content="4 Epicrop | Epidemiologia de enfermedades de cultivos" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Epicrop | Epidemiologia de enfermedades de cultivos" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Epicrop | Epidemiologia de enfermedades de cultivos" />
  
  
  

<meta name="author" content="Juan Edwards" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="1_3-epifitter.html"/>
<link rel="next" href="2_2-epicrop_ej.html"/>
<script src="libs/header-attrs-2.9/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Inicio</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="1_1-comparar_curvas.html"><a href="1_1-comparar_curvas.html"><i class="fa fa-check"></i><b>1</b> Curvas de progreso</a></li>
<li class="chapter" data-level="2" data-path="1_2-logistico_aplicado.html"><a href="1_2-logistico_aplicado.html"><i class="fa fa-check"></i><b>2</b> Logístico aplicado</a></li>
<li class="chapter" data-level="3" data-path="1_3-epifitter.html"><a href="1_3-epifitter.html"><i class="fa fa-check"></i><b>3</b> Epifitter</a>
<ul>
<li class="chapter" data-level="3.1" data-path="1_3-epifitter.html"><a href="1_3-epifitter.html#estimating-k-maximum-disease"><i class="fa fa-check"></i><b>3.1</b> Estimating K (maximum disease)</a></li>
<li class="chapter" data-level="3.2" data-path="1_3-epifitter.html"><a href="1_3-epifitter.html#fit-models-to-multiple-dpcs"><i class="fa fa-check"></i><b>3.2</b> Fit models to multiple DPCs</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="2_1-epicrop.html"><a href="2_1-epicrop.html"><i class="fa fa-check"></i><b>4</b> Epicrop</a>
<ul>
<li class="chapter" data-level="4.1" data-path="2_1-epicrop.html"><a href="2_1-epicrop.html#predict-bacterial-blight---wet-season"><i class="fa fa-check"></i><b>4.1</b> Predict bacterial blight - wet season</a></li>
<li class="chapter" data-level="4.2" data-path="2_1-epicrop.html"><a href="2_1-epicrop.html#predict-leaf-blast---wet-season"><i class="fa fa-check"></i><b>4.2</b> Predict leaf blast - wet season</a></li>
<li class="chapter" data-level="4.3" data-path="2_1-epicrop.html"><a href="2_1-epicrop.html#comparando-epidemias"><i class="fa fa-check"></i><b>4.3</b> Comparando epidemias</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="2_2-epicrop_ej.html"><a href="2_2-epicrop_ej.html"><i class="fa fa-check"></i><b>5</b> Hands on with epicrop</a>
<ul>
<li class="chapter" data-level="5.1" data-path="2_2-epicrop_ej.html"><a href="2_2-epicrop_ej.html#exercise-1"><i class="fa fa-check"></i><b>5.1</b> Exercise 1</a></li>
<li class="chapter" data-level="5.2" data-path="2_2-epicrop_ej.html"><a href="2_2-epicrop_ej.html#exercise-2"><i class="fa fa-check"></i><b>5.2</b> Exercise 2</a></li>
<li class="chapter" data-level="5.3" data-path="2_2-epicrop_ej.html"><a href="2_2-epicrop_ej.html#exercise-3"><i class="fa fa-check"></i><b>5.3</b> Exercise 3</a></li>
<li class="chapter" data-level="5.4" data-path="2_2-epicrop_ej.html"><a href="2_2-epicrop_ej.html#exercise-4"><i class="fa fa-check"></i><b>5.4</b> Exercise 4</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="2_2-epicrop_ej.html"><a href="2_2-epicrop_ej.html#calculating-audpc"><i class="fa fa-check"></i><b>5.4.1</b> Calculating AUDPC</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="2_2-epicrop_ej.html"><a href="2_2-epicrop_ej.html#exercise-5"><i class="fa fa-check"></i><b>5.5</b> Exercise 5</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Epidemiologia de enfermedades de cultivos</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="epicrop" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Epicrop</h1>
<p>Autor: Adam H. Sparks</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="2_1-epicrop.html#cb50-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(<span class="st">&quot;epifitter&quot;</span>, <span class="st">&quot;tidyverse&quot;</span>)</span></code></pre></div>
<p><em>epicrop</em> provee un paquete del modelo ‘EPIRICE’(Savary <em>et al.</em> 2012), el cual se basa en la prediccion de enfermedad por medio de modelo SEIR (Susceptible-Exposed-Infectious-Removed</p>
<p>Cinco enfermedades de arroz (sin ningun manejo) se pueden modelar con las funciones:</p>
<ul>
<li>bacterial blight (<code>predict_bacterial_blight()</code>)</li>
<li>brown spot (<code>predict_brown_spot()</code>)</li>
<li>leaf blast (<code>predict_leaf_blast()</code>)</li>
<li>sheath blight (<code>predict_sheath_blight()</code>)</li>
<li>tungro (<code>predict_tungro()</code>)</li>
</ul>
<p>El modelo utiliza datos meteorológicos diarios para estimar la intensidad de la enfermedad.</p>
<p>La funcion, <code>get_wth()</code> permite descargar datos meteorológicos de <a href="https://power.larc.nasa.gov">NASA POWER API</a>, listos para ser usados en <em>epicrop</em>.</p>
<p>El uso de las funciones del paquete está diseñado para ser sencillo para modelar los riesgos de enfermedades del arroz, pero lo suficientemente flexible para adaptarse a otros patosistemas que utilizan la función <code>SEIR()</code>.</p>
<p>Si está interesado en modelar otros patosistemas, consulte Savary et al. (2012) para el desarrollo de los parámetros que se utilizaron para las enfermedades del arroz según se derivan de la literatura existente y se implementan en las funciones del modelo de enfermedad individual.</p>
<p>Inicio</p>
<p>Cargue el paquete</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="2_1-epicrop.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;epicrop&quot;</span>)</span></code></pre></div>
<p>Obtener datos meteorológicos</p>
<p>NOTA: hubieron varios casos de error en la instalación de epicrop, algunos de los cuales se resolvieron con la instalacion de Rtools, de acuerdo a los mensajes de error que salian en la consola.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="2_1-epicrop.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># correr solo en caso que no ande el siguiente chunk</span></span>
<span id="cb52-2"><a href="2_1-epicrop.html#cb52-2" aria-hidden="true" tabindex="-1"></a>installr<span class="sc">::</span><span class="fu">install.Rtools</span>()</span></code></pre></div>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="2_1-epicrop.html#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fetch weather for year 2000 season at the IRRI Zeigler Experiment Station</span></span>
<span id="cb53-2"><a href="2_1-epicrop.html#cb53-2" aria-hidden="true" tabindex="-1"></a>wth <span class="ot">&lt;-</span> <span class="fu">get_wth</span>(</span>
<span id="cb53-3"><a href="2_1-epicrop.html#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># lonlat = c(-58.25614, -37.84632), # Balcarce</span></span>
<span id="cb53-4"><a href="2_1-epicrop.html#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">lonlat =</span> <span class="fu">c</span>(<span class="fl">121.25562</span>, <span class="fl">14.6774</span>),</span>
<span id="cb53-5"><a href="2_1-epicrop.html#cb53-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">dates =</span> <span class="fu">c</span>(<span class="st">&quot;2000-01-01&quot;</span>, <span class="st">&quot;2000-12-31&quot;</span>)</span>
<span id="cb53-6"><a href="2_1-epicrop.html#cb53-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb53-7"><a href="2_1-epicrop.html#cb53-7" aria-hidden="true" tabindex="-1"></a>wth</span></code></pre></div>
<p>Otras vias de importación de datos desde archivos locales.
Sirve de ejemplo de como deberian ser nuestros datos en caso que usemos de una estacion meteorológica local.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="2_1-epicrop.html#cb54-1" aria-hidden="true" tabindex="-1"></a>wth <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">&quot;data/chirps.csv&quot;</span>)</span></code></pre></div>
<div id="predict-bacterial-blight---wet-season" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Predict bacterial blight - wet season</h2>
<p>Todas las funciones de la familia <code>predict _ ()</code> funcionan exactamente de la misma manera.
Se le proporciona datos meteorológicos y una fecha de aparición, que se encuentra dentro de los datos meteorológicos proporcionados. Devolverá un marco de datos de la intensidad de la enfermedad durante la temporada y otros valores asociados con el modelo.</p>
<p>Consulte el archivo de ayuda de <code>SEIR ()</code> para obtener más información sobre los valores devueltos.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="2_1-epicrop.html#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict bacterial blight intensity for the year 2000 wet season at IRRI</span></span>
<span id="cb55-2"><a href="2_1-epicrop.html#cb55-2" aria-hidden="true" tabindex="-1"></a>bb_wet <span class="ot">&lt;-</span> <span class="fu">predict_bacterial_blight</span>(wth, <span class="at">emergence =</span> <span class="st">&quot;2000-07-01&quot;</span>)</span></code></pre></div>
<p>Vemos los resultados de la funcion anterior:</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="2_1-epicrop.html#cb56-1" aria-hidden="true" tabindex="-1"></a>bb_wet</span></code></pre></div>
<p>Graficos con ggplot2</p>
<p>Los datos están en un formato apaisado (wide) por defecto y deben convertirse a formato largo (long) para usarlos en <em>ggplot2</em> si desea graficar más de una variable a la vez.</p>
<p>El modelo registra la cantidad de sitios para cada status a escala diaria; esto se puede graficar de la siguiente manera.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="2_1-epicrop.html#cb57-1" aria-hidden="true" tabindex="-1"></a>bb_wet <span class="sc">%&gt;%</span> </span>
<span id="cb57-2"><a href="2_1-epicrop.html#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb57-3"><a href="2_1-epicrop.html#cb57-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">c</span>(<span class="st">&quot;diseased&quot;</span>, <span class="st">&quot;removed&quot;</span>, <span class="st">&quot;latent&quot;</span>, <span class="st">&quot;infectious&quot;</span>),</span>
<span id="cb57-4"><a href="2_1-epicrop.html#cb57-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">&quot;site&quot;</span>,</span>
<span id="cb57-5"><a href="2_1-epicrop.html#cb57-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">&quot;value&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb57-6"><a href="2_1-epicrop.html#cb57-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb57-7"><a href="2_1-epicrop.html#cb57-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> dates, <span class="at">y =</span> value, <span class="at">shape =</span> site, <span class="at">linetype =</span> site) <span class="sc">+</span></span>
<span id="cb57-8"><a href="2_1-epicrop.html#cb57-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Sites&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Date&quot;</span>, <span class="at">title =</span> <span class="st">&quot;Bacterial blight&quot;</span>) <span class="sc">+</span></span>
<span id="cb57-9"><a href="2_1-epicrop.html#cb57-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> site, <span class="at">colour =</span> site)) <span class="sc">+</span></span>
<span id="cb57-10"><a href="2_1-epicrop.html#cb57-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> site)) <span class="sc">+</span></span>
<span id="cb57-11"><a href="2_1-epicrop.html#cb57-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="ot">-&gt;</span> p1 </span>
<span id="cb57-12"><a href="2_1-epicrop.html#cb57-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-13"><a href="2_1-epicrop.html#cb57-13" aria-hidden="true" tabindex="-1"></a>p1</span></code></pre></div>
</div>
<div id="predict-leaf-blast---wet-season" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Predict leaf blast - wet season</h2>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="2_1-epicrop.html#cb58-1" aria-hidden="true" tabindex="-1"></a>lb_wet <span class="ot">&lt;-</span> <span class="fu">predict_leaf_blast</span>(wth, <span class="at">emergence =</span> <span class="st">&quot;2000-07-01&quot;</span>)</span>
<span id="cb58-2"><a href="2_1-epicrop.html#cb58-2" aria-hidden="true" tabindex="-1"></a>lb_wet</span></code></pre></div>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="2_1-epicrop.html#cb59-1" aria-hidden="true" tabindex="-1"></a>lb_wet <span class="sc">%&gt;%</span> </span>
<span id="cb59-2"><a href="2_1-epicrop.html#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb59-3"><a href="2_1-epicrop.html#cb59-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">c</span>(<span class="st">&quot;diseased&quot;</span>, <span class="st">&quot;removed&quot;</span>, <span class="st">&quot;latent&quot;</span>, <span class="st">&quot;infectious&quot;</span>),</span>
<span id="cb59-4"><a href="2_1-epicrop.html#cb59-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">&quot;site&quot;</span>,</span>
<span id="cb59-5"><a href="2_1-epicrop.html#cb59-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">&quot;value&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb59-6"><a href="2_1-epicrop.html#cb59-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb59-7"><a href="2_1-epicrop.html#cb59-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> dates,<span class="at">y =</span> value,<span class="at">shape =</span> site, <span class="at">linetype =</span> site) <span class="sc">+</span></span>
<span id="cb59-8"><a href="2_1-epicrop.html#cb59-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Sites&quot;</span>,</span>
<span id="cb59-9"><a href="2_1-epicrop.html#cb59-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Date&quot;</span>, <span class="at">title=</span> <span class="st">&quot;Leaf blast&quot;</span>) <span class="sc">+</span></span>
<span id="cb59-10"><a href="2_1-epicrop.html#cb59-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> site, <span class="at">colour =</span> site)) <span class="sc">+</span></span>
<span id="cb59-11"><a href="2_1-epicrop.html#cb59-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> site)) <span class="sc">+</span></span>
<span id="cb59-12"><a href="2_1-epicrop.html#cb59-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="ot">-&gt;</span> p2</span></code></pre></div>
<p>Cargamos el paquete <code>patchwork</code> que nos permite organizar plots individuales</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="2_1-epicrop.html#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span></code></pre></div>
<p>vemos como colecta las leyendas de ambos graficos y se usa un titulo en comun</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="2_1-epicrop.html#cb61-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> <span class="fu">plot_annotation</span>(<span class="at">title =</span> <span class="st">&#39;Wet season&#39;</span>)<span class="sc">+</span>  </span>
<span id="cb61-2"><a href="2_1-epicrop.html#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">&quot;collect&quot;</span>) <span class="sc">&amp;</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;bottom&#39;</span>)</span></code></pre></div>
<p>Graficar la intensidad a lo largo del tiempo no requiere ninguna manipulación de datos.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="2_1-epicrop.html#cb62-1" aria-hidden="true" tabindex="-1"></a>bb_wet <span class="sc">%&gt;%</span> </span>
<span id="cb62-2"><a href="2_1-epicrop.html#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb62-3"><a href="2_1-epicrop.html#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> dates, <span class="at">y =</span> intensity) <span class="sc">+</span></span>
<span id="cb62-4"><a href="2_1-epicrop.html#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Intensity (%)&quot;</span>,</span>
<span id="cb62-5"><a href="2_1-epicrop.html#cb62-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Date&quot;</span>) <span class="sc">+</span></span>
<span id="cb62-6"><a href="2_1-epicrop.html#cb62-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb62-7"><a href="2_1-epicrop.html#cb62-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb62-8"><a href="2_1-epicrop.html#cb62-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
</div>
<div id="comparando-epidemias" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Comparando epidemias</h2>
<p>La forma más común de comparar epidemias de enfermedades en epidemiología botánica es utilizar el área bajo la curva del progreso de la enfermedad (AUDPC) (Shaner y Finney 1977).</p>
<p>Esto se calcula fácilmente a partir de la salida de cualquiera de la familia de funciones <code>predict _ ()</code> o una ejecución personalizada de <code>SEIR ()</code> usando el paquete <em>epifitter</em> (Alves y Del Ponte 2020).</p>
<p>Cargue <em>epifitter</em> y simule la intensidad de la enfermedad en la estación seca a partir de enero para comparar con los resultados iniciales de “bb_wet”.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="2_1-epicrop.html#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;epifitter&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="2_1-epicrop.html#cb64-1" aria-hidden="true" tabindex="-1"></a>bb_dry <span class="ot">&lt;-</span> <span class="fu">predict_bacterial_blight</span>(<span class="at">wth =</span> wth, <span class="at">emergence =</span> <span class="st">&quot;2000-01-05&quot;</span>)</span>
<span id="cb64-2"><a href="2_1-epicrop.html#cb64-2" aria-hidden="true" tabindex="-1"></a>bb_dry</span></code></pre></div>
<ul>
<li>Estación seca</li>
</ul>
<p>Verifique la curva de progreso de la enfermedad para la estación seca</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="2_1-epicrop.html#cb65-1" aria-hidden="true" tabindex="-1"></a>bb_dry <span class="sc">%&gt;%</span> </span>
<span id="cb65-2"><a href="2_1-epicrop.html#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb65-3"><a href="2_1-epicrop.html#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> dates, <span class="at">y =</span> intensity) <span class="sc">+</span></span>
<span id="cb65-4"><a href="2_1-epicrop.html#cb65-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Intensity (%)&quot;</span>,</span>
<span id="cb65-5"><a href="2_1-epicrop.html#cb65-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Date&quot;</span>) <span class="sc">+</span></span>
<span id="cb65-6"><a href="2_1-epicrop.html#cb65-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb65-7"><a href="2_1-epicrop.html#cb65-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb65-8"><a href="2_1-epicrop.html#cb65-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p>Calcule el AUDPC usando el <code>AUDPC ()</code> de <em>epifitter</em> para ambas temporadas y compare</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="2_1-epicrop.html#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dry season</span></span>
<span id="cb66-2"><a href="2_1-epicrop.html#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">AUDPC</span>(</span>
<span id="cb66-3"><a href="2_1-epicrop.html#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">time =</span> bb_dry<span class="sc">$</span>simday,</span>
<span id="cb66-4"><a href="2_1-epicrop.html#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> bb_dry<span class="sc">$</span>intensity,</span>
<span id="cb66-5"><a href="2_1-epicrop.html#cb66-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">y_proportion =</span> <span class="cn">FALSE</span>,</span>
<span id="cb66-6"><a href="2_1-epicrop.html#cb66-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;absolute&quot;</span>)</span>
<span id="cb66-7"><a href="2_1-epicrop.html#cb66-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-8"><a href="2_1-epicrop.html#cb66-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Wet season</span></span>
<span id="cb66-9"><a href="2_1-epicrop.html#cb66-9" aria-hidden="true" tabindex="-1"></a><span class="fu">AUDPC</span>(</span>
<span id="cb66-10"><a href="2_1-epicrop.html#cb66-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">time =</span> bb_wet<span class="sc">$</span>simday,</span>
<span id="cb66-11"><a href="2_1-epicrop.html#cb66-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> bb_wet<span class="sc">$</span>intensity,</span>
<span id="cb66-12"><a href="2_1-epicrop.html#cb66-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">y_proportion =</span> <span class="cn">FALSE</span>,</span>
<span id="cb66-13"><a href="2_1-epicrop.html#cb66-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;absolute&quot;</span></span>
<span id="cb66-14"><a href="2_1-epicrop.html#cb66-14" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>El AUDPC de la estación húmeda es mayor que el de la estación seca.
Por lo tanto, esto cumple con las expectativas de que el AUDPC de la temporada de lluvias es más alto que la temporada seca, que se pronosticó que tendría una menor intensidad de la enfermedad.</p>
<p><strong>Referencias</strong></p>
<p>Kaique dos S. Alves and Emerson M. Del Ponte (2020). epifitter: Analysis and Simulation of Plant Disease Progress Curves. R package version 0.2.0. URL: <a href="https://CRAN.R-project.org/package=epifitter" class="uri">https://CRAN.R-project.org/package=epifitter</a>.</p>
<p>Serge Savary, Andrew Nelson, Laetitia Willocquet, Ireneo Pangga and Jorrel Aunario. Modeling and mapping potential epidemics of rice diseases globally. <em>Crop Protection</em>, Volume 34, 2012, Pages 6-17, ISSN 0261-2194 DOI: <a href="https://doi.org/10.1016/j.cropro.2011.11.009">10.1016/j.cropro.2011.11.009</a>.</p>
<p>Gregory Shaner and R. E. Finney. "The effect of nitrogen fertilization on the expression of slow-mildewing resistance in Knox wheat. <em>Phytopathology</em> Volume 67.8, 1977, Pages 1051-1056.</p>
<p>Adam Sparks (2018). nasapower: A NASA POWER Global Meteorology, Surface Solar Energy and Climatology Data
Client for R. Journal of Open Source Software, 3(30), 1035, DOI: <a href="https://doi.org/10.21105/joss.01035">10.21105/joss.01035</a>.</p>
<p>Adam Sparks (2020). <em>nasapower: NASA-POWER Data from R</em>. R package version 3.0.1, URL: <a href="https://CRAN.R-project.org/package=nasapower" class="uri">https://CRAN.R-project.org/package=nasapower</a>.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="1_3-epifitter.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="2_2-epicrop_ej.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
