<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6 SAD | Fitopatometría en R</title>
  <meta name="description" content="6 SAD | Fitopatometría en R" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="6 SAD | Fitopatometría en R" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 SAD | Fitopatometría en R" />
  
  
  

<meta name="author" content="Juan Edwards" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="2_1-pliman.html"/>

<script src="libs/header-attrs-2.9/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Inicio</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="0-data.html"><a href="0-data.html"><i class="fa fa-check"></i>Datasets</a></li>
<li class="chapter" data-level="1" data-path="1_1-metricas_basicas.html"><a href="1_1-metricas_basicas.html"><i class="fa fa-check"></i><b>1</b> Métricas báscias</a>
<ul>
<li class="chapter" data-level="1.1" data-path="1_1-metricas_basicas.html"><a href="1_1-metricas_basicas.html#incidencia"><i class="fa fa-check"></i><b>1.1</b> Incidencia</a></li>
<li class="chapter" data-level="1.2" data-path="1_1-metricas_basicas.html"><a href="1_1-metricas_basicas.html#prevalencia"><i class="fa fa-check"></i><b>1.2</b> Prevalencia</a></li>
<li class="chapter" data-level="1.3" data-path="1_1-metricas_basicas.html"><a href="1_1-metricas_basicas.html#severidad"><i class="fa fa-check"></i><b>1.3</b> Severidad</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="1_2-dsi.html"><a href="1_2-dsi.html"><i class="fa fa-check"></i><b>2</b> DSI</a></li>
<li class="chapter" data-level="3" data-path="1_3-auc.html"><a href="1_3-auc.html"><i class="fa fa-check"></i><b>3</b> AUC</a></li>
<li class="chapter" data-level="4" data-path="1_4-inductoras_de_senescencia.html"><a href="1_4-inductoras_de_senescencia.html"><i class="fa fa-check"></i><b>4</b> Enfermedades que inducen senescencia</a></li>
<li class="chapter" data-level="5" data-path="2_1-pliman.html"><a href="2_1-pliman.html"><i class="fa fa-check"></i><b>5</b> Pliman</a></li>
<li class="chapter" data-level="6" data-path="2_2-sad.html"><a href="2_2-sad.html"><i class="fa fa-check"></i><b>6</b> SAD</a>
<ul>
<li class="chapter" data-level="6.1" data-path="2_2-sad.html"><a href="2_2-sad.html#lins-concordance"><i class="fa fa-check"></i><b>6.1</b> Lin’s concordance</a></li>
<li class="chapter" data-level="6.2" data-path="2_2-sad.html"><a href="2_2-sad.html#interrater-reliability"><i class="fa fa-check"></i><b>6.2</b> Interrater reliability</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Fitopatometría en R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sad" class="section level1" number="6">
<h1><span class="header-section-number">6</span> SAD</h1>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="2_2-sad.html#cb88-1" aria-hidden="true" tabindex="-1"></a>sad_wide_raw <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;sad&quot;</span>, <span class="st">&quot;data&quot;</span>, <span class="st">&quot;data-sad.csv&quot;</span>))</span>
<span id="cb88-2"><a href="2_2-sad.html#cb88-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-3"><a href="2_2-sad.html#cb88-3" aria-hidden="true" tabindex="-1"></a>sad_wide_raw <span class="sc">%&gt;%</span> </span>
<span id="cb88-4"><a href="2_2-sad.html#cb88-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(method, <span class="fu">c</span>(<span class="st">&quot;author&quot;</span>,<span class="st">&quot;method&quot;</span>),  <span class="st">&quot;_&quot;</span>) <span class="sc">%&gt;%</span>   </span>
<span id="cb88-5"><a href="2_2-sad.html#cb88-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character, as.factor) <span class="sc">%&gt;%</span> </span>
<span id="cb88-6"><a href="2_2-sad.html#cb88-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(author, method), fct_rev) <span class="ot">-&gt;</span> sad_wide</span>
<span id="cb88-7"><a href="2_2-sad.html#cb88-7" aria-hidden="true" tabindex="-1"></a>sad_wide</span></code></pre></div>
<p>We need to reshape this data frame to the tidy format, where all responses are in a single column which facilitates further work within the <code>tidyverse</code>. For this, we use the <code>gather</code> function and create the <code>rater</code> and the <code>estimate</code> variables to accomodate data from the multiple columns. We should indicate the columns to gather, which are 4 to 23 and this way the first three columns are kept as we want: method, leaf and actual severity.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="2_2-sad.html#cb89-1" aria-hidden="true" tabindex="-1"></a>sad_wide <span class="sc">%&gt;%</span></span>
<span id="cb89-2"><a href="2_2-sad.html#cb89-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span> <span class="dv">5</span><span class="sc">:</span><span class="dv">24</span>, </span>
<span id="cb89-3"><a href="2_2-sad.html#cb89-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;rater&quot;</span>, </span>
<span id="cb89-4"><a href="2_2-sad.html#cb89-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;estimate&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb89-5"><a href="2_2-sad.html#cb89-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(rater), as.numeric) <span class="ot">-&gt;</span> sad</span>
<span id="cb89-6"><a href="2_2-sad.html#cb89-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-7"><a href="2_2-sad.html#cb89-7" aria-hidden="true" tabindex="-1"></a>sad</span></code></pre></div>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="2_2-sad.html#cb90-1" aria-hidden="true" tabindex="-1"></a>sad <span class="sc">%&gt;%</span></span>
<span id="cb90-2"><a href="2_2-sad.html#cb90-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span> method, <span class="at">y =</span> estimate <span class="sc">-</span> actual)) <span class="sc">+</span></span>
<span id="cb90-3"><a href="2_2-sad.html#cb90-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="st">&quot;author&quot;</span>)<span class="sc">+</span></span>
<span id="cb90-4"><a href="2_2-sad.html#cb90-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb90-5"><a href="2_2-sad.html#cb90-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width=</span>.<span class="dv">1</span>, <span class="at">alpha=</span>.<span class="dv">2</span>) </span></code></pre></div>
<p>First the absolute value</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="2_2-sad.html#cb91-1" aria-hidden="true" tabindex="-1"></a>sad <span class="sc">%&gt;%</span></span>
<span id="cb91-2"><a href="2_2-sad.html#cb91-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>leaf, <span class="at">y=</span>actual, <span class="at">color =</span> method)) <span class="sc">+</span></span>
<span id="cb91-3"><a href="2_2-sad.html#cb91-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="st">&quot;author&quot;</span>)<span class="sc">+</span></span>
<span id="cb91-4"><a href="2_2-sad.html#cb91-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(leaf, actual, <span class="at">color =</span> <span class="st">&quot;actual&quot;</span>),<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb91-5"><a href="2_2-sad.html#cb91-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(leaf, estimate), <span class="at">size =</span> <span class="fl">1.5</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb91-6"><a href="2_2-sad.html#cb91-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(leaf, estimate), <span class="at">se =</span> F) <span class="sc">+</span></span>
<span id="cb91-7"><a href="2_2-sad.html#cb91-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Severity (%)&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Leaf ordered by increasing severity (0.25 to 84%)&quot;</span>)</span></code></pre></div>
<p>Error of the estimates</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="2_2-sad.html#cb92-1" aria-hidden="true" tabindex="-1"></a>sad <span class="sc">%&gt;%</span></span>
<span id="cb92-2"><a href="2_2-sad.html#cb92-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span> leaf, <span class="at">y=</span>estimate <span class="sc">-</span> actual, <span class="at">color =</span> method)) <span class="sc">+</span></span>
<span id="cb92-3"><a href="2_2-sad.html#cb92-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="st">&quot;author&quot;</span>)<span class="sc">+</span></span>
<span id="cb92-4"><a href="2_2-sad.html#cb92-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb92-5"><a href="2_2-sad.html#cb92-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(leaf, estimate <span class="sc">-</span> actual), <span class="at">size =</span> <span class="fl">1.5</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb92-6"><a href="2_2-sad.html#cb92-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(leaf, estimate <span class="sc">-</span> actual), <span class="at">se =</span> F) <span class="sc">+</span></span>
<span id="cb92-7"><a href="2_2-sad.html#cb92-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Severity&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Leaf ordered by increasing severity (0.25 to 84%)&quot;</span>)</span></code></pre></div>
<p>Per rater</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="2_2-sad.html#cb93-1" aria-hidden="true" tabindex="-1"></a>sad <span class="sc">%&gt;%</span></span>
<span id="cb93-2"><a href="2_2-sad.html#cb93-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(leaf, actual, <span class="at">col =</span> method)) <span class="sc">+</span></span>
<span id="cb93-3"><a href="2_2-sad.html#cb93-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(leaf, estimate), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb93-4"><a href="2_2-sad.html#cb93-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(leaf, estimate), <span class="at">se =</span> F) <span class="sc">+</span></span>
<span id="cb93-5"><a href="2_2-sad.html#cb93-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> author<span class="sc">*</span>rater) <span class="sc">+</span></span>
<span id="cb93-6"><a href="2_2-sad.html#cb93-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Value&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Leaf&quot;</span>)</span></code></pre></div>
<p>And now for the error of the estimates.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="2_2-sad.html#cb94-1" aria-hidden="true" tabindex="-1"></a>sad <span class="sc">%&gt;%</span></span>
<span id="cb94-2"><a href="2_2-sad.html#cb94-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(leaf, estimate <span class="sc">-</span> actual, <span class="at">color =</span> method)) <span class="sc">+</span></span>
<span id="cb94-3"><a href="2_2-sad.html#cb94-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb94-4"><a href="2_2-sad.html#cb94-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(leaf, estimate <span class="sc">-</span> actual), <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb94-5"><a href="2_2-sad.html#cb94-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(leaf, estimate <span class="sc">-</span> actual), <span class="at">se =</span> F) <span class="sc">+</span></span>
<span id="cb94-6"><a href="2_2-sad.html#cb94-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(author<span class="sc">~</span> rater) <span class="sc">+</span></span>
<span id="cb94-7"><a href="2_2-sad.html#cb94-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Value&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Leaf&quot;</span>)</span></code></pre></div>
<p>In the plots above we showed the error of the estimates by leaf, and although we know that severity was incremental, we had no information on this values. Hence, we can make another plot with severity on the x axis and identify ranges of actual severity with higher errors and compare the two SADs.</p>
<div id="lins-concordance" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> Lin’s concordance</h2>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="2_2-sad.html#cb95-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(purrr, broom, epiR,lme4, car, emmeans, multcomp)</span></code></pre></div>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="2_2-sad.html#cb96-1" aria-hidden="true" tabindex="-1"></a>?<span class="fu">epi.ccc</span>() </span></code></pre></div>
<p>Veamos como opera la función <code>epi.ccc</code>. Para ello tomemos el primer evaluador de todo el dataset:</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="2_2-sad.html#cb97-1" aria-hidden="true" tabindex="-1"></a>sad <span class="sc">%&gt;%</span> </span>
<span id="cb97-2"><a href="2_2-sad.html#cb97-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="at">data =</span> <span class="fu">c</span>(leaf, actual, estimate)) <span class="sc">%&gt;%</span> </span>
<span id="cb97-3"><a href="2_2-sad.html#cb97-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb97-4"><a href="2_2-sad.html#cb97-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data) <span class="ot">-&gt;</span> rater_1</span></code></pre></div>
<p>Ahora si, apliquemos la funcion para <code>rater_1</code></p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="2_2-sad.html#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">epi.ccc</span>(rater_1<span class="sc">$</span>actual, rater_1<span class="sc">$</span>estimate,  <span class="at">ci =</span> <span class="st">&quot;z-transform&quot;</span>, <span class="at">conf.level =</span> <span class="fl">0.95</span>)</span></code></pre></div>
<p>Calculando las metricas de manera serial para todos los evaluadores</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="2_2-sad.html#cb99-1" aria-hidden="true" tabindex="-1"></a>ccc_func <span class="ot">&lt;-</span> <span class="cf">function</span>(.) {</span>
<span id="cb99-2"><a href="2_2-sad.html#cb99-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">epi.ccc</span>(.<span class="sc">$</span>actual, .<span class="sc">$</span>estimate,  <span class="at">ci =</span> <span class="st">&quot;z-transform&quot;</span>, <span class="at">conf.level =</span> <span class="fl">0.95</span>)</span>
<span id="cb99-3"><a href="2_2-sad.html#cb99-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="2_2-sad.html#cb100-1" aria-hidden="true" tabindex="-1"></a>sad <span class="sc">%&gt;%</span> </span>
<span id="cb100-2"><a href="2_2-sad.html#cb100-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="at">data =</span> <span class="fu">c</span>(leaf, actual, estimate)) <span class="ot">-&gt;</span> nested_sad</span></code></pre></div>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="2_2-sad.html#cb101-1" aria-hidden="true" tabindex="-1"></a>nested_sad</span></code></pre></div>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="2_2-sad.html#cb102-1" aria-hidden="true" tabindex="-1"></a>nested_sad <span class="sc">%&gt;%</span> </span>
<span id="cb102-2"><a href="2_2-sad.html#cb102-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fit =</span> <span class="fu">map</span>(data, ccc_func)) <span class="ot">-&gt;</span> metrics</span>
<span id="cb102-3"><a href="2_2-sad.html#cb102-3" aria-hidden="true" tabindex="-1"></a>metrics</span></code></pre></div>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="2_2-sad.html#cb103-1" aria-hidden="true" tabindex="-1"></a>metrics <span class="sc">%&gt;%</span> </span>
<span id="cb103-2"><a href="2_2-sad.html#cb103-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(fit) <span class="sc">%&gt;%</span> </span>
<span id="cb103-3"><a href="2_2-sad.html#cb103-3" aria-hidden="true" tabindex="-1"></a>  rowwise <span class="sc">%&gt;%</span> </span>
<span id="cb103-4"><a href="2_2-sad.html#cb103-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fit =</span> <span class="fu">toString</span>(<span class="fu">unlist</span>(fit))) <span class="sc">%&gt;%</span></span>
<span id="cb103-5"><a href="2_2-sad.html#cb103-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(author, method, rater) <span class="sc">%&gt;%</span> </span>
<span id="cb103-6"><a href="2_2-sad.html#cb103-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">string =</span> <span class="fu">paste</span>(fit, <span class="at">collapse =</span> <span class="st">&quot;_&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb103-7"><a href="2_2-sad.html#cb103-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(<span class="at">col =</span> string, </span>
<span id="cb103-8"><a href="2_2-sad.html#cb103-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;LCC&quot;</span>, <span class="st">&quot;s_shift&quot;</span>, <span class="st">&quot;l_shift&quot;</span>, <span class="st">&quot;C_b&quot;</span>), </span>
<span id="cb103-9"><a href="2_2-sad.html#cb103-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb103-10"><a href="2_2-sad.html#cb103-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(<span class="at">col =</span> LCC, </span>
<span id="cb103-11"><a href="2_2-sad.html#cb103-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;LCC&quot;</span>, <span class="st">&quot;ccc.lower&quot;</span>, <span class="st">&quot;ccc.upper&quot;</span>), </span>
<span id="cb103-12"><a href="2_2-sad.html#cb103-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">sep =</span> <span class="st">&quot;,&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb103-13"><a href="2_2-sad.html#cb103-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(author, method, rater), as.factor) <span class="sc">%&gt;%</span> </span>
<span id="cb103-14"><a href="2_2-sad.html#cb103-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character, as.double) <span class="sc">%&gt;%</span> </span>
<span id="cb103-15"><a href="2_2-sad.html#cb103-15" aria-hidden="true" tabindex="-1"></a>  ungroup <span class="ot">-&gt;</span> metric_results<span class="co">#</span></span></code></pre></div>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="2_2-sad.html#cb104-1" aria-hidden="true" tabindex="-1"></a>metric_results <span class="sc">%&gt;%</span> </span>
<span id="cb104-2"><a href="2_2-sad.html#cb104-2" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code></pre></div>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="2_2-sad.html#cb105-1" aria-hidden="true" tabindex="-1"></a>metric_results <span class="sc">%&gt;%</span> </span>
<span id="cb105-2"><a href="2_2-sad.html#cb105-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(author, method) <span class="sc">%&gt;%</span> </span>
<span id="cb105-3"><a href="2_2-sad.html#cb105-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_if</span>(is.numeric, mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb105-4"><a href="2_2-sad.html#cb105-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># select(l_shift, s_shift, C_b, ) %&gt;% </span></span>
<span id="cb105-5"><a href="2_2-sad.html#cb105-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(LCC))</span></code></pre></div>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="2_2-sad.html#cb106-1" aria-hidden="true" tabindex="-1"></a>metric_old <span class="ot">&lt;-</span> metric_results <span class="sc">%&gt;%</span> </span>
<span id="cb106-2"><a href="2_2-sad.html#cb106-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(author <span class="sc">==</span> <span class="st">&quot;old&quot;</span>)</span>
<span id="cb106-3"><a href="2_2-sad.html#cb106-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-4"><a href="2_2-sad.html#cb106-4" aria-hidden="true" tabindex="-1"></a>metric_new <span class="ot">&lt;-</span> metric_results <span class="sc">%&gt;%</span> </span>
<span id="cb106-5"><a href="2_2-sad.html#cb106-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(author <span class="sc">==</span> <span class="st">&quot;new&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="2_2-sad.html#cb107-1" aria-hidden="true" tabindex="-1"></a>pc_old <span class="ot">&lt;-</span> <span class="fu">lmer</span>(LCC <span class="sc">~</span> method <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> rater), <span class="at">data =</span> metric_old, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb107-2"><a href="2_2-sad.html#cb107-2" aria-hidden="true" tabindex="-1"></a>means_pc_old <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(pc_old, <span class="sc">~</span> method)</span>
<span id="cb107-3"><a href="2_2-sad.html#cb107-3" aria-hidden="true" tabindex="-1"></a>res_pc_old <span class="ot">&lt;-</span> <span class="fu">cld</span>(means_pc_old, <span class="at">Letters=</span>letters)</span>
<span id="cb107-4"><a href="2_2-sad.html#cb107-4" aria-hidden="true" tabindex="-1"></a>res_pc_old</span></code></pre></div>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="2_2-sad.html#cb108-1" aria-hidden="true" tabindex="-1"></a>pc_new <span class="ot">&lt;-</span> <span class="fu">lmer</span>(LCC <span class="sc">~</span> method <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> rater), <span class="at">data =</span> metric_new, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb108-2"><a href="2_2-sad.html#cb108-2" aria-hidden="true" tabindex="-1"></a>means_pc_new <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(pc_new, <span class="sc">~</span> method)</span>
<span id="cb108-3"><a href="2_2-sad.html#cb108-3" aria-hidden="true" tabindex="-1"></a>res_pc_new <span class="ot">&lt;-</span> <span class="fu">cld</span>(means_pc_new, <span class="at">Letters=</span>letters)</span>
<span id="cb108-4"><a href="2_2-sad.html#cb108-4" aria-hidden="true" tabindex="-1"></a>res_pc_new</span></code></pre></div>
</div>
<div id="interrater-reliability" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> Interrater reliability</h2>
<p>Two methods were used here. The overall concordance coefficient and the intra-class correlation coefficient.</p>
<ul>
<li>No aid old</li>
</ul>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="2_2-sad.html#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(irr)</span></code></pre></div>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="2_2-sad.html#cb110-1" aria-hidden="true" tabindex="-1"></a>sad <span class="sc">%&gt;%</span> </span>
<span id="cb110-2"><a href="2_2-sad.html#cb110-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(author<span class="sc">==</span><span class="st">&quot;old&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb110-3"><a href="2_2-sad.html#cb110-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(method<span class="sc">==</span><span class="st">&quot;noaid&quot;</span>) <span class="ot">-&gt;</span> sad_noaid_old </span></code></pre></div>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="2_2-sad.html#cb111-1" aria-hidden="true" tabindex="-1"></a>sad_noaid_old <span class="sc">%&gt;%</span> </span>
<span id="cb111-2"><a href="2_2-sad.html#cb111-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> rater, </span>
<span id="cb111-3"><a href="2_2-sad.html#cb111-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb111-4"><a href="2_2-sad.html#cb111-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="dv">5</span><span class="sc">:</span><span class="dv">23</span>) <span class="sc">%&gt;%</span></span>
<span id="cb111-5"><a href="2_2-sad.html#cb111-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.matrix</span>() <span class="ot">-&gt;</span> sad_noaid_old2</span></code></pre></div>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="2_2-sad.html#cb112-1" aria-hidden="true" tabindex="-1"></a>sad_occc_noaid_old <span class="ot">&lt;-</span> <span class="fu">epi.occc</span>(sad_noaid_old2, <span class="at">na.rm =</span> <span class="cn">FALSE</span>, <span class="at">pairs =</span> <span class="cn">TRUE</span>)</span>
<span id="cb112-2"><a href="2_2-sad.html#cb112-2" aria-hidden="true" tabindex="-1"></a>sad_icc_noaid_old <span class="ot">&lt;-</span> <span class="fu">icc</span>(sad_noaid_old2, <span class="at">model =</span> <span class="st">&quot;twoway&quot;</span>, <span class="at">unit =</span> <span class="st">&quot;single&quot;</span>, <span class="at">type =</span> <span class="st">&quot;consistency&quot;</span>)</span>
<span id="cb112-3"><a href="2_2-sad.html#cb112-3" aria-hidden="true" tabindex="-1"></a>sad_occc_noaid_old<span class="sc">$</span>occc</span>
<span id="cb112-4"><a href="2_2-sad.html#cb112-4" aria-hidden="true" tabindex="-1"></a>sad_icc_noaid_old<span class="sc">$</span>value</span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="2_1-pliman.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection",
"scroll_highlight": true
}
});
});
</script>

</body>

</html>
