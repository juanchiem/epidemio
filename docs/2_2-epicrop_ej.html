<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4.4 Exercise 1 | Hands on with epicrop</title>
  <meta name="description" content="4.4 Exercise 1 | Hands on with epicrop" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="4.4 Exercise 1 | Hands on with epicrop" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4.4 Exercise 1 | Hands on with epicrop" />
  
  
  

<meta name="author" content="Adam H. Sparks" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="2_1-epicrop.html"/>

<script src="libs/header-attrs-2.9/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Inicio</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="1_1-comparar_curvas.html"><a href="1_1-comparar_curvas.html"><i class="fa fa-check"></i><b>1</b> Curvas de progreso</a></li>
<li class="chapter" data-level="2" data-path="1_2-logistico_aplicado.html"><a href="1_2-logistico_aplicado.html"><i class="fa fa-check"></i><b>2</b> Log√≠stico aplicado</a></li>
<li class="chapter" data-level="3" data-path="1_3-epifitter.html"><a href="1_3-epifitter.html"><i class="fa fa-check"></i><b>3</b> Epifitter</a>
<ul>
<li class="chapter" data-level="3.1" data-path="1_3-epifitter.html"><a href="1_3-epifitter.html#estimating-k-maximum-disease"><i class="fa fa-check"></i><b>3.1</b> Estimating K (maximum disease)</a></li>
<li class="chapter" data-level="3.2" data-path="1_3-epifitter.html"><a href="1_3-epifitter.html#fit-models-to-multiple-dpcs"><i class="fa fa-check"></i><b>3.2</b> Fit models to multiple DPCs</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="2_1-epicrop.html"><a href="2_1-epicrop.html"><i class="fa fa-check"></i><b>4</b> Epicrop</a>
<ul>
<li class="chapter" data-level="4.1" data-path="2_1-epicrop.html"><a href="2_1-epicrop.html#predict-bacterial-blight---wet-season"><i class="fa fa-check"></i><b>4.1</b> Predict bacterial blight - wet season</a></li>
<li class="chapter" data-level="4.2" data-path="2_1-epicrop.html"><a href="2_1-epicrop.html#predict-leaf-blast---wet-season"><i class="fa fa-check"></i><b>4.2</b> Predict leaf blast - wet season</a></li>
<li class="chapter" data-level="4.3" data-path="2_1-epicrop.html"><a href="2_1-epicrop.html#comparando-epidemias"><i class="fa fa-check"></i><b>4.3</b> Comparando epidemias</a></li>
<li class="chapter" data-level="4.4" data-path="2_2-epicrop_ej.html"><a href="2_2-epicrop_ej.html"><i class="fa fa-check"></i><b>4.4</b> Exercise 1</a></li>
<li class="chapter" data-level="4.5" data-path="2_2-epicrop_ej.html"><a href="2_2-epicrop_ej.html#exercise-2"><i class="fa fa-check"></i><b>4.5</b> Exercise 2</a></li>
<li class="chapter" data-level="4.6" data-path="2_2-epicrop_ej.html"><a href="2_2-epicrop_ej.html#exercise-3"><i class="fa fa-check"></i><b>4.6</b> Exercise 3</a></li>
<li class="chapter" data-level="4.7" data-path="2_2-epicrop_ej.html"><a href="2_2-epicrop_ej.html#exercise-4"><i class="fa fa-check"></i><b>4.7</b> Exercise 4</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="2_2-epicrop_ej.html"><a href="2_2-epicrop_ej.html#calculating-audpc"><i class="fa fa-check"></i><b>4.7.1</b> Calculating AUDPC</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="2_2-epicrop_ej.html"><a href="2_2-epicrop_ej.html#exercise-5"><i class="fa fa-check"></i><b>4.8</b> Exercise 5</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Hands on with epicrop</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="2_2-epicrop_ej.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;epicrop&quot;</span>)</span>
<span id="cb1-2"><a href="2_2-epicrop_ej.html#cb1-2" aria-hidden="true" tabindex="-1"></a>?<span class="fu">SEIR</span>()</span></code></pre></div>
<ul>
<li><p>The parameters</p></li>
<li><p><code>wth</code></p>
<p>The first parameter, <code>wth</code>, is a data.frame object of weather to drive the model.
<em>epicrop</em> has relatively simple needs for weather to run the model.
Daily temperature, relative humidity and rainfall are all that are required.</p>
<p><em>epicrop</em> has a built-in function, <code>get_wth()</code> that will automatically fetch and format the weather data for use in <code>SEIR()</code> (or any of the other specialised functions for modelling disease) from two possible databases.
The default database is the NASA POWER API, <a href="https://power.larc.nasa.gov" class="uri">https://power.larc.nasa.gov</a>.
The optional database is the CHIRPS and CHIRTS APIs, <a href="https://chc.ucsb.edu/data" class="uri">https://chc.ucsb.edu/data</a>.</p></li>
<li><p><code>emergence</code></p>
<p>The date that the crop emerges, or if transplanted rice, is transplanted.</p></li>
<li><p><code>onset</code>
The expected number of days until the onset of disease after emergence date (day, integer).
Described in Table 1 of Savary <em>et al.</em> 2012.</p></li>
<li><p><code>duration</code></p>
<p>Simulation duration <em>i.e.</em>, growing season length (day, integer).
Described in Table 1 of Savary <em>et al.</em> 2012.</p></li>
<li><p><code>rhlim</code></p>
<p>Relative humidity value threshold to decide whether leaves are wet or not (numeric).
Savary <em>et al.</em> 2012 used 90%.</p></li>
<li><p><code>rainlim</code></p>
<p>Rainfall amount (mm) threshold to decide whether leaves are wet or not (numeric).
Savary <em>et al.</em> 2012 used 5mm.</p></li>
<li><p><code>H0</code></p>
<p>Initial number of plant‚Äôs healthy sites (integer).
Described in Table 1 of Savary <em>et al.</em> 2012.</p></li>
<li><p><code>I0</code></p>
<p>Initial number of infective sites (integer).
Described in Table 1 of Savary <em>et al.</em> 2012.</p></li>
<li><p><code>RcA</code></p>
<p>Modifier for <em>Rc</em> (the basic infection rate corrected for removals) for crop age (numeric vector).
Described in Table 1 of Savary <em>et al.</em> 2012.</p></li>
<li><p><code>RcT</code></p>
<p>Modifier for <em>Rc</em> (the basic infection rate corrected for removals) for temperature (numeric vector).
Described in Table 1 of Savary <em>et al.</em> 2012.</p></li>
<li><p><code>RcOpt</code></p>
<p>Potential basic infection rate corrected for removals (numeric).
Derived from Table 1 of Savary <em>et al.</em> 2012.</p></li>
<li><p><code>i</code></p>
<p>Duration of infectious period (day, integer).
Described in Table 1 of Savary <em>et al.</em> 2012.</p></li>
<li><p><code>p</code></p>
<p>Duration of latent period (day, integer).
Described in Table 1 of Savary <em>et al.</em> 2012.</p></li>
<li><p><code>Sx</code></p>
<p>The maximum number of sites (integer).
Described in Table 1 of Savary <em>et al.</em> 2012.</p></li>
<li><p><code>a</code></p>
<p>The aggregation coefficient, values are from 1 to &gt;1 (numeric).
Described in Table 1 of Savary <em>et al.</em> 2012.</p></li>
<li><p><code>RRS</code></p>
<p>Relative rate of physiological senescence (numeric).
Described in Table 1 of Savary <em>et al.</em> 2012.</p></li>
<li><p><code>RRG</code></p>
<p>Relative rate of growth (numeric).
Described in Table 1 of Savary <em>et al.</em> 2012.</p></li>
<li><p>The ‚Äúpredict‚Äù family of functions</p></li>
</ul>
<p>Currently <em>epicrop</em> provides five pre-parameterised functions to predict rice diseases.
These functions are the EPICROP model as published by Savary <em>et al.</em> 2012.</p>
<ul>
<li><code>predict_bacterial_blight()</code>,</li>
<li><code>predict_brown_spot()</code>,</li>
<li><code>predict_leaf_blast()</code>,</li>
<li><code>predict_sheath_blight()</code>, and</li>
<li><code>predict_tungro()</code></li>
</ul>
<p>You can view the help file for any of them using the same as above, <code>?predict_bacterial_blight</code>.</p>
<ul>
<li>Using the ‚Äúpredict‚Äù functions</li>
</ul>
<p>I have attempted to make it as simple as possible to use these functions and generate model outputs.
Modelling and plotting the disease progress over time for bacterial leaf blight is as follows.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="2_2-epicrop_ej.html#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get weather for IRRI Zeigler Experiment Station in wet season 2000</span></span>
<span id="cb2-2"><a href="2_2-epicrop_ej.html#cb2-2" aria-hidden="true" tabindex="-1"></a>wth <span class="ot">&lt;-</span> <span class="fu">get_wth</span>(</span>
<span id="cb2-3"><a href="2_2-epicrop_ej.html#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">lonlat =</span> <span class="fu">c</span>(<span class="fl">121.25562</span>, <span class="fl">14.6774</span>),</span>
<span id="cb2-4"><a href="2_2-epicrop_ej.html#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">dates =</span> <span class="fu">c</span>(<span class="st">&quot;2000-06-30&quot;</span>, <span class="st">&quot;2000-12-31&quot;</span>),</span>
<span id="cb2-5"><a href="2_2-epicrop_ej.html#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">source =</span> <span class="st">&quot;chirps&quot;</span></span>
<span id="cb2-6"><a href="2_2-epicrop_ej.html#cb2-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-7"><a href="2_2-epicrop_ej.html#cb2-7" aria-hidden="true" tabindex="-1"></a>bb <span class="ot">&lt;-</span> <span class="fu">predict_bacterial_blight</span>(wth, <span class="at">emergence =</span> <span class="st">&quot;2000-07-01&quot;</span>)</span>
<span id="cb2-8"><a href="2_2-epicrop_ej.html#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> bb<span class="sc">$</span>dates, <span class="at">y =</span> bb<span class="sc">$</span>intensity, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p>However, right now the POWER data‚Äôs precipitation is corrupted and CHRIPS/CHIRTS are very slow to respond.
So, we‚Äôll use some CHIRPS/CHIRTS data that I downloaded for us to use in these exercises.
These data are for the IRRI Zeigler Experiment Station in Los Ba√±os, Philippines for 2000 and 2001.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="2_2-epicrop_ej.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load them in your R session</span></span>
<span id="cb3-2"><a href="2_2-epicrop_ej.html#cb3-2" aria-hidden="true" tabindex="-1"></a>chirps <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;chirps.rds&quot;</span>)</span>
<span id="cb3-3"><a href="2_2-epicrop_ej.html#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="2_2-epicrop_ej.html#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb3-5"><a href="2_2-epicrop_ej.html#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(chirps)</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="2_2-epicrop_ej.html#cb4-1" aria-hidden="true" tabindex="-1"></a>bb_wet <span class="ot">&lt;-</span> <span class="fu">predict_bacterial_blight</span>(chirps, <span class="at">emergence =</span> <span class="st">&quot;2000-07-01&quot;</span>)</span>
<span id="cb4-2"><a href="2_2-epicrop_ej.html#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> bb_wet<span class="sc">$</span>dates, <span class="at">y =</span> bb_wet<span class="sc">$</span>intensity, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<ul>
<li>Differences in the five functions</li>
</ul>
<p>If you look at the code for the five functions, you will see that they each have their own values for the parameters found in <code>SEIR()</code>.
All of the functions can be found in the GitHub repository, <a href="https://github.com/adamhsparks/epicrop/tree/main/R" class="uri">https://github.com/adamhsparks/epicrop/tree/main/R</a>.
We will look at <code>predict_bacterial_blight()</code> first.</p>
<p>On <a href="https://github.com/adamhsparks/epicrop/blob/b3c85b997180c3f90e67cc02a5e58d62491d9edd/R/predict_bacterial_blight.R#L92">line 92</a> we see that the <code>age_coef_rc</code> is set up as:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="2_2-epicrop_ej.html#cb5-1" aria-hidden="true" tabindex="-1"></a>  age_coef_rc <span class="ot">&lt;-</span></span>
<span id="cb5-2"><a href="2_2-epicrop_ej.html#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cbind</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">12</span> <span class="sc">*</span> <span class="dv">10</span>,</span>
<span id="cb5-3"><a href="2_2-epicrop_ej.html#cb5-3" aria-hidden="true" tabindex="-1"></a>          <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">0.9</span>, <span class="fl">0.62</span>, <span class="fl">0.43</span>, <span class="fl">0.41</span>, <span class="fl">0.42</span>, <span class="fl">0.41</span>, <span class="fl">0.41</span>, <span class="fl">0.41</span>, <span class="fl">0.41</span>, <span class="fl">0.41</span>))</span></code></pre></div>
<p>and the <code>temp_coef_rc</code> is set up as:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="2_2-epicrop_ej.html#cb6-1" aria-hidden="true" tabindex="-1"></a>  temp_coef_rc <span class="ot">&lt;-</span></span>
<span id="cb6-2"><a href="2_2-epicrop_ej.html#cb6-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cbind</span>(<span class="dv">16</span> <span class="sc">+</span> (<span class="dv">0</span><span class="sc">:</span><span class="dv">8</span> <span class="sc">*</span> <span class="dv">3</span>),</span>
<span id="cb6-3"><a href="2_2-epicrop_ej.html#cb6-3" aria-hidden="true" tabindex="-1"></a>          <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.29</span>, <span class="fl">0.44</span>, <span class="fl">0.90</span>, <span class="fl">0.90</span>, <span class="fl">1.0</span>, <span class="fl">0.88</span>, <span class="fl">0.01</span>, <span class="dv">0</span>))</span></code></pre></div>
<p>These values are used in the <code>RcA</code> and <code>RcT</code> parameters of <code>SEIR()</code> to modify the disease‚Äôs progress.</p>
<p>I find it easier to think about how this affects the model by visualising what this is creating.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="2_2-epicrop_ej.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> age_coef_rc[, <span class="dv">1</span>], <span class="at">y =</span> age_coef_rc[, <span class="dv">2</span>], <span class="at">main =</span> <span class="st">&quot;BB age_coef_rc&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="2_2-epicrop_ej.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> temp_coef_rc[, <span class="dv">1</span>], <span class="at">y =</span> temp_coef_rc[, <span class="dv">2</span>], <span class="at">main =</span> <span class="st">&quot;BB temp_coef_rc&quot;</span>)</span></code></pre></div>
</div>
<div id="exercise-1" class="section level2" number="4.4">
<h2><span class="header-section-number">4.4</span> Exercise 1</h2>
<p>Now, you compare these curves with the curves for leaf blast and answer the following questions.</p>
<ol style="list-style-type: decimal">
<li><p>How do they differ?</p></li>
<li><p>What does this imply about the pathogens and diseases that they cause?</p></li>
</ol>
<p>Now compare one of the other disease models‚Äô curves with these two and see how they differ.</p>
<p>All of the code for the disease models are available <a href="https://github.com/adamhsparks/epicrop/tree/main/R">here</a>.</p>
<ul>
<li>RcOpt</li>
</ul>
<p>We saw <code>RcOpt</code> in the presentation.
It is the reference potential value of the basic infection rate corrected for removals for each disease.
The default value for <code>predict_bacterial_blight()</code> is 0.87 while for <code>predict_leaf_blast()</code> it is 1.14.</p>
</div>
<div id="exercise-2" class="section level2" number="4.5">
<h2><span class="header-section-number">4.5</span> Exercise 2</h2>
<p>Discuss how this value changing affects the disease progress.
What does a higher or lower value for <code>RcOpt</code> mean?</p>
<ul>
<li>H0, I0 and Sx</li>
</ul>
<p>Consider the <code>H0</code> and <code>I0</code> parameters for the different diseases.
The model works for several types of disease, leaf area, whole leaf, tiller, whole plant all in a 1m^2 area.</p>
</div>
<div id="exercise-3" class="section level2" number="4.6">
<h2><span class="header-section-number">4.6</span> Exercise 3</h2>
<ol style="list-style-type: decimal">
<li><p>What are <code>H0</code>, <code>I0</code> and <code>Sx</code>?</p></li>
<li><p>How are they related?</p></li>
<li><p>Consider how these values might differ between the functions/diseases.</p></li>
<li><p>Explain how/why these values differ.</p></li>
<li><pre><code>a. Are there other scales or plant organs that you would consider if you were adding new diseases?
b. What disease would these be (does not have to be rice)?
c. What might the default value be for the new disease?</code></pre></li>
</ol>
<ul>
<li>p</li>
</ul>
<p>We did not see <code>p</code>, <em>per se</em> in the presentation but we did cover the idea of latent and infectious sites.
<code>p</code> controls the latent period, that is how long a site remains in the <code>E</code> (exposed) state of SEIR before becoming infectious.</p>
</div>
<div id="exercise-4" class="section level2" number="4.7">
<h2><span class="header-section-number">4.7</span> Exercise 4</h2>
<p>Compare and contrast the different values for <code>p</code> from each of the <code>predict</code> functions.</p>
<ol style="list-style-type: decimal">
<li>What does this tell you about the pathogens‚Äô life-cycle and reproductive strategies?</li>
<li>Which one has the shortest latent period?</li>
<li>Which one has the longest latent period?</li>
</ol>
<ul>
<li>RRS and RRG</li>
</ul>
<p>The last parameters in the model are <code>RRS</code> and <code>RRG</code>, or the relative rate of senescence and the relative rate of growth.
Both of these parameters relate to the crop itself.</p>
<p>Compare the values found in the different <code>predict</code> functions.</p>
<ol style="list-style-type: decimal">
<li>Which are different and which are the same?</li>
<li>How would changing these values affect the rate of disease progress?</li>
</ol>
<ul>
<li>Working with <em>epicrop</em> outputs</li>
</ul>
<p><code>SEIR()</code> produces data tables that start on day 0, establishment or emergence and progress to the end of the season, <code>duration</code>.
By default in the <code>predict</code> functions, this is 120 days for a 120 day rice crop.</p>
<p>There are 16 possible columns, 14 will always be returned with <code>lat</code> and <code>lon</code> optionally returned if provided in the <code>wth</code> weather input object.
Any values calculated by the model are available at the end of the run.</p>
<ul>
<li>Description of fields and values from SEIR() output</li>
</ul>
<p>1 <strong>simday</strong> Zero indexed day of simulation that was run
2 <strong>dates</strong> Date of simulation
3 <strong>sites</strong> Total number of sites present on day ‚Äúx‚Äù
4 <strong>latent</strong> Number of latent sites present on day ‚Äúx‚Äù
5 <strong>infectious</strong> Number of infectious sites present on day ‚Äúx‚Äù
6 <strong>removed</strong> Number of removed sites present on day ‚Äúx‚Äù
7 <strong>senesced</strong> Number of senesced sites present on day ‚Äúx‚Äù
8 <strong>ratinf</strong> Rate of infection
9 <strong>rtransfer</strong> Rate of transfer from latent to infectious sites
10 <strong>rgrowth</strong> Rate of growth of healthy sites
11 <strong>rsenesced</strong> Rate of senescence of healthy sites
12 <strong>rlex</strong> Rate of lesion expansion
13 <strong>diseased</strong> Number of diseased (latent + infectious + removed) sites on
14 <strong>intensity</strong> Proportion of diseased (latent + infectious + removed) sites per total sites not including removed sites on day ‚Äúx‚Äù
15 <strong>lat</strong> Latitude value if provided by <code>wth</code> object
16 <strong>lon</strong> Longitude value if provided by <code>wth</code> object</p>
<p>Comparing seasons</p>
<p>Using the <em>epifitter</em> package (Alves and Del Ponte 2021) we can calculate the area under the disease progress curve (AUDPC) and compare disease progress in different seasons of the same year.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="2_2-epicrop_ej.html#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">&quot;epifitter&quot;</span>))</span>
<span id="cb10-2"><a href="2_2-epicrop_ej.html#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">&quot;epifitter&quot;</span>)</span>
<span id="cb10-3"><a href="2_2-epicrop_ej.html#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;epifitter&quot;</span>)</span></code></pre></div>
<p>The data are already loaded.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="2_2-epicrop_ej.html#cb11-1" aria-hidden="true" tabindex="-1"></a>chirps</span></code></pre></div>
<p>So we can proceed running the bacterial blight model for the dry season in the same location.
To do this, all that is necessary is to change the emergence date to January 1, 2000, which corresponds to a 120 day growing season that starts in the dry season.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="2_2-epicrop_ej.html#cb12-1" aria-hidden="true" tabindex="-1"></a>bb_dry <span class="ot">&lt;-</span> <span class="fu">predict_bacterial_blight</span>(chirps, <span class="at">emergence =</span> <span class="st">&quot;2000-01-01&quot;</span>)</span>
<span id="cb12-2"><a href="2_2-epicrop_ej.html#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> bb_dry<span class="sc">$</span>dates, <span class="at">y =</span> bb_dry<span class="sc">$</span>intensity, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<div id="calculating-audpc" class="section level3" number="4.7.1">
<h3><span class="header-section-number">4.7.1</span> Calculating AUDPC</h3>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="2_2-epicrop_ej.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># wet season</span></span>
<span id="cb13-2"><a href="2_2-epicrop_ej.html#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">AUDPC</span>(</span>
<span id="cb13-3"><a href="2_2-epicrop_ej.html#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">time =</span> bb_wet<span class="sc">$</span>simday,</span>
<span id="cb13-4"><a href="2_2-epicrop_ej.html#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> bb_wet<span class="sc">$</span>intensity,</span>
<span id="cb13-5"><a href="2_2-epicrop_ej.html#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">y_proportion =</span> <span class="cn">FALSE</span>,</span>
<span id="cb13-6"><a href="2_2-epicrop_ej.html#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;absolute&quot;</span></span>
<span id="cb13-7"><a href="2_2-epicrop_ej.html#cb13-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-8"><a href="2_2-epicrop_ej.html#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="2_2-epicrop_ej.html#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co"># dry season</span></span>
<span id="cb13-10"><a href="2_2-epicrop_ej.html#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="fu">AUDPC</span>(</span>
<span id="cb13-11"><a href="2_2-epicrop_ej.html#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">time =</span> bb_dry<span class="sc">$</span>simday,</span>
<span id="cb13-12"><a href="2_2-epicrop_ej.html#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> bb_dry<span class="sc">$</span>intensity,</span>
<span id="cb13-13"><a href="2_2-epicrop_ej.html#cb13-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">y_proportion =</span> <span class="cn">FALSE</span>,</span>
<span id="cb13-14"><a href="2_2-epicrop_ej.html#cb13-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;absolute&quot;</span></span>
<span id="cb13-15"><a href="2_2-epicrop_ej.html#cb13-15" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>The AUDPC of the wet season is greater than that of the dry season.
So, this meets the expectations that the wet season AUDPC is higher than the dry season, which for bacterial blight makes sense as the pathogen needs leaf moisture and wind to move, infect and reproduce.</p>
</div>
</div>
<div id="exercise-5" class="section level2" number="4.8">
<h2><span class="header-section-number">4.8</span> Exercise 5</h2>
<ol style="list-style-type: decimal">
<li><p>Explore different emergence dates to find a date with a higher or lower AUDPC than the current wet and dry season values.
There are two years of weather data in the <code>chirps</code> data that I‚Äôve provided starting from 2000-01-01 to 2001-12-31, which allows for several establishment dates to be compared.</p></li>
<li><p>Explore the AUDPC for the other diseases in <em>epicrop</em>.
Which ones are worse in the wet season and which are worse in the dry season, do some not show as much difference between seasons?</p></li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="2_1-epicrop.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection",
"scroll_highlight": true
}
});
});
</script>

</body>

</html>
